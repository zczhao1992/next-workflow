(()=>{var e={};e.id=238,e.ids=[238],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},78018:e=>{"use strict";e.exports=require("puppeteer")},71396:e=>{"use strict";e.exports=require("undici")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},6005:e=>{"use strict";e.exports=require("node:crypto")},84492:e=>{"use strict";e.exports=require("node:stream")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},71576:e=>{"use strict";e.exports=require("string_decoder")},57310:e=>{"use strict";e.exports=require("url")},11325:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>c,routeModule:()=>f,tree:()=>o}),s(77131),s(1576),s(56656),s(61692),s(12523);var r=s(23191),a=s(88716),l=s(37922),n=s.n(l),d=s(95231),i={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>d[e]);s.d(t,i);let o=["",{children:["workflow",{children:["runs",{children:["[workflowId]",{children:["[executionId]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,77131)),"E:\\Demo\\next-workflow\\src\\app\\workflow\\runs\\[workflowId]\\[executionId]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,1576)),"E:\\Demo\\next-workflow\\src\\app\\workflow\\runs\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,56656)),"E:\\Demo\\next-workflow\\src\\app\\workflow\\layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,61692)),"E:\\Demo\\next-workflow\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,12523)),"E:\\Demo\\next-workflow\\src\\app\\not-found.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["E:\\Demo\\next-workflow\\src\\app\\workflow\\runs\\[workflowId]\\[executionId]\\page.tsx"],u="/workflow/runs/[workflowId]/[executionId]/page",x={require:s,loadChunk:()=>Promise.resolve()},f=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/workflow/runs/[workflowId]/[executionId]/page",pathname:"/workflow/runs/[workflowId]/[executionId]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},54905:(e,t,s)=>{let r={"02006b721cfdf268750b6832501dc53a02328319":()=>Promise.resolve().then(s.bind(s,6254)).then(e=>e.GetWorkflowExecutionWithPhases)};async function a(e,...t){return(await r[e]()).apply(null,t)}e.exports={"02006b721cfdf268750b6832501dc53a02328319":a.bind(null,"02006b721cfdf268750b6832501dc53a02328319")}},73687:(e,t,s)=>{let r={"3047de3067a82dc5453db7770d6038992ed5e3bf":()=>Promise.resolve().then(s.bind(s,56496)).then(e=>e.updateWorkflow),"3ee51c67189e2b7d6a121d0e57c2859697778aaa":()=>Promise.resolve().then(s.bind(s,42259)).then(e=>e.RunWorkflow),"6c1c04f605a38c8567e83c8e6f7ca0ebcd48984a":()=>Promise.resolve().then(s.bind(s,94106)).then(e=>e.publishWorkflow),"7218128e2cdf4273bd91f89961a1eedd113c31ea":()=>Promise.resolve().then(s.bind(s,31178)).then(e=>e.unpublishWorkflow),"371342ddd9d25e7209bd4ab82d3ac8c0750847c0":()=>Promise.resolve().then(s.bind(s,34987)).then(e=>e.GetWorkflowPhaseDetails),b15e8abe97d493bd29a52f19533c6ef64bdb497c:()=>Promise.resolve().then(s.bind(s,3479)).then(e=>e.invalidateCacheAction)};async function a(e,...t){return(await r[e]()).apply(null,t)}e.exports={"3047de3067a82dc5453db7770d6038992ed5e3bf":a.bind(null,"3047de3067a82dc5453db7770d6038992ed5e3bf"),"3ee51c67189e2b7d6a121d0e57c2859697778aaa":a.bind(null,"3ee51c67189e2b7d6a121d0e57c2859697778aaa"),"6c1c04f605a38c8567e83c8e6f7ca0ebcd48984a":a.bind(null,"6c1c04f605a38c8567e83c8e6f7ca0ebcd48984a"),"7218128e2cdf4273bd91f89961a1eedd113c31ea":a.bind(null,"7218128e2cdf4273bd91f89961a1eedd113c31ea"),"371342ddd9d25e7209bd4ab82d3ac8c0750847c0":a.bind(null,"371342ddd9d25e7209bd4ab82d3ac8c0750847c0"),b15e8abe97d493bd29a52f19533c6ef64bdb497c:a.bind(null,"b15e8abe97d493bd29a52f19533c6ef64bdb497c")}},69207:(e,t,s)=>{Promise.resolve().then(s.bind(s,20149)),Promise.resolve().then(s.bind(s,79629))},48998:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(62881).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},77506:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(62881).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},79629:(e,t,s)=>{"use strict";s.d(t,{default:()=>C});var r=s(10326),a=s(17577),l=s(20108),n=s(73178),d=s(70835),i=s(62881);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,i.Z)("CircleDashed",[["path",{d:"M10.1 2.182a10 10 0 0 1 3.8 0",key:"5ilxe3"}],["path",{d:"M13.9 21.818a10 10 0 0 1-3.8 0",key:"11zvb9"}],["path",{d:"M17.609 3.721a10 10 0 0 1 2.69 2.7",key:"1iw5b2"}],["path",{d:"M2.182 13.9a10 10 0 0 1 0-3.8",key:"c0bmvh"}],["path",{d:"M20.279 17.609a10 10 0 0 1-2.7 2.69",key:"1ruxm7"}],["path",{d:"M21.818 10.1a10 10 0 0 1 0 3.8",key:"qkgqxc"}],["path",{d:"M3.721 6.391a10 10 0 0 1 2.7-2.69",key:"1mcia2"}],["path",{d:"M6.391 20.279a10 10 0 0 1-2.69-2.7",key:"1fvljs"}]]),c=(0,i.Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var u=s(48998),x=s(77506);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let f=(0,i.Z)("Workflow",[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]]);var p=s(78062),m=s(91664),h=s(38443),b=s(29752),w=s(41190),N=s(41156);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let v=(0,i.Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),y=(0,i.Z)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var g=s(79481);function j({status:e}){switch(e){case g.KD.PENDING:return r.jsx(o,{size:20,className:"stroke-muted-foreground"});case g.KD.RUNNING:return r.jsx(x.Z,{size:20,className:"animate-spin stroke-yellow-500"});case g.KD.FAILED:return r.jsx(v,{size:20,className:"stroke-destructive"});case g.KD.COMPLETED:return r.jsx(y,{size:20,className:"stroke-green-500"});default:return r.jsx("div",{className:"rounded-full",children:{CREATED:"已创建",PENDING:"等待中",RUNNING:"运行中",COMPLETED:"运行成功",FAILED:"已失败"}[e]})}}s(15424);var k=s(46242),E=(0,k.$)("02006b721cfdf268750b6832501dc53a02328319"),I=(0,k.$)("371342ddd9d25e7209bd4ab82d3ac8c0750847c0"),D=s(51223),P=s(9730);function C({initialData:e}){let[t,s]=(0,a.useState)(null),i=(0,l.a)({queryKey:["execution",e?.id],initialData:e,queryFn:()=>E(e.id),refetchInterval:e=>e.state.data?.status===g.B6.RUNNING&&1e3}),b=(0,l.a)({queryKey:["phaseDetails",t,i.data?.status],enabled:null!==t,queryFn:()=>I(t)}),w=i.data?.status===g.B6.RUNNING,N=(0,P.h)(i.data?.completedAt,i.data?.startedAt);return(0,r.jsxs)("div",{className:"flex w-full h-full",children:[(0,r.jsxs)("aside",{className:"w-[440px] min-w-[440px] max-w-[440px] border-r-2 border-separate flex flex-grow flex-col overflow-hidden",children:[(0,r.jsxs)("div",{className:"py-4 px-2",children:[r.jsx(q,{icon:o,label:"状态",value:(0,r.jsxs)("div",{className:"font-semibold capitalize flex gap-2 items-center",children:[r.jsx(j,{status:i.data?.status}),r.jsx("span",{children:{CREATED:"已创建",PENDING:"等待中",RUNNING:"运行中",COMPLETED:"运行成功",FAILED:"已失败"}[i.data?.status]})]})}),r.jsx(q,{icon:c,label:"开始时间",value:r.jsx("span",{className:"lowercase",children:i.data?.startedAt?(0,n.Q)(new Date(i.data?.startedAt),{addSuffix:!0,locale:d.U}):"-"})}),r.jsx(q,{icon:u.Z,label:"运行时间",value:N||r.jsx(x.Z,{size:20,className:"animate-spin"})})]}),r.jsx(p.Separator,{}),r.jsx("div",{className:"flex justify-center items-center py-2 px-4",children:(0,r.jsxs)("div",{className:"text-muted-foreground flex items-center gap-2",children:[r.jsx(f,{size:20,className:"stroke-muted-foreground/80"}),r.jsx("span",{className:"font-semibold",children:"运行步骤"})]})}),r.jsx(p.Separator,{}),r.jsx("div",{className:"overflow-auto h-full px-2 py-4",children:i.data?.phases.map((e,a)=>r.jsxs(m.z,{variant:t===e.id?"secondary":"ghost",className:"w-full justify-between",onClick:()=>{w||s(e.id)},children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(h.C,{variant:"outline",children:a+1}),r.jsx("p",{className:"font-semibold",children:e.name})]}),r.jsx(j,{status:e.status})]},e.id))})]}),(0,r.jsxs)("div",{className:"flex w-full h-full",children:[w&&r.jsx("div",{className:"flex items-center flex-col gap-2 justify-center h-full w-full",children:r.jsx("p",{className:"font-bold",children:"正在运行, 请等待"})}),!w&&!t&&r.jsx("div",{className:"flex items-center flex-col gap-2 justify-center h-full w-full",children:(0,r.jsxs)("div",{className:"flex flex-col gap-1 text-center",children:[r.jsx("p",{className:"font-bold",children:"没有步骤被选中"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"请选择步骤查看详细信息"})]})}),!w&&t&&b.data&&(0,r.jsxs)("div",{className:"flex flex-col py-4 container gap-4 overflow-auto",children:[r.jsx("div",{className:"flex gap-2 items-center",children:(0,r.jsxs)(h.C,{variant:"outline",className:"space-x-4",children:[(0,r.jsxs)("div",{className:"flex gap-1 items-center",children:[r.jsx(u.Z,{size:18,className:"stroke-muted-foreground"}),r.jsx("span",{children:"运行时间"})]}),r.jsx("span",{children:(0,P.h)(b.data.completedAt,b.data.startedAt)||"-"})]})}),r.jsx(A,{title:"输入",subtitle:"用于此阶段的输入",paramsJson:b.data.inputs}),r.jsx(A,{title:"输出",subtitle:"此阶段生成的输出",paramsJson:b.data.outputs}),r.jsx(R,{logs:b.data.logs})]})]})]})}function q({icon:e,label:t,value:s}){return(0,r.jsxs)("div",{className:"flex justify-between items-center py-2 px-4 text-sm",children:[(0,r.jsxs)("div",{className:"text-muted-foreground flex items-center gap-2",children:[r.jsx(e,{size:20,className:"stroke-muted-foreground/80"}),r.jsx("span",{children:t})]}),r.jsx("div",{className:"font-semibold capitalize flex gap-2 items-center",children:s})]})}function A({title:e,subtitle:t,paramsJson:s}){let a=s?JSON.parse(s):void 0;return(0,r.jsxs)(b.Zb,{children:[(0,r.jsxs)(b.Ol,{className:"rounded-lg rounded-b-none border-b py-4 bg-gray-50 dark:bg-background",children:[r.jsx(b.ll,{className:"text-base",children:e}),r.jsx(b.SZ,{className:"text-muted-foreground text-sm",children:t})]}),r.jsx(b.aY,{className:"py-4",children:(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(!a||0===Object.keys(a).length)&&r.jsx("p",{className:"text-sm",children:"此阶段未生成任何参数"}),a&&Object.entries(a).map(([e,t])=>(0,r.jsxs)("div",{className:"flex justify-between items-center space-y-1",children:[r.jsx("p",{className:"text-sm text-muted-foreground flex-1 basis-1/3",children:e}),r.jsx(w.I,{readOnly:!0,className:"flex-1 basis-2/3",value:t})]},e))]})})]})}function R({logs:e}){return e&&0!==e.length?(0,r.jsxs)(b.Zb,{className:"w-full",children:[(0,r.jsxs)(b.Ol,{className:"rounded-lg rounded-b-none border-b py-4 bg-gray-50 dark:bg-background",children:[r.jsx(b.ll,{className:"text-base",children:"日志"}),r.jsx(b.SZ,{className:"text-muted-foreground text-sm",children:"此阶段生成的日志"})]}),r.jsx(b.aY,{className:"p-0",children:(0,r.jsxs)(N.iA,{children:[r.jsx(N.xD,{className:"text-muted-foreground text-sm",children:(0,r.jsxs)(N.SC,{children:[r.jsx(N.ss,{children:"日期"}),r.jsx(N.ss,{children:"类型"}),r.jsx(N.ss,{children:"消息"})]})}),r.jsx(N.RM,{children:e.map(e=>(0,r.jsxs)(N.SC,{className:"text-muted-foreground",children:[r.jsx(N.pj,{width:190,className:"text-xs text-muted-foreground p-[2px] pl-4",children:e.timestamp.toISOString()}),r.jsx(N.pj,{width:80,className:(0,D.cn)("uppercase text-xs font-bold p-[3px] pl-4","error"===e.logLevel&&"text-destructive","info"===e.logLevel&&"text-primary"),children:e.logLevel}),r.jsx(N.pj,{className:"text-sm flex-1 p-[3px] pl-4",children:e.message})]},e.id))})]})})]}):null}},38443:(e,t,s)=>{"use strict";s.d(t,{C:()=>d});var r=s(10326);s(17577);var a=s(79360),l=s(51223);let n=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d({className:e,variant:t,...s}){return r.jsx("div",{className:(0,l.cn)(n({variant:t}),e),...s})}},29752:(e,t,s)=>{"use strict";s.d(t,{Ol:()=>d,SZ:()=>o,Zb:()=>n,aY:()=>c,ll:()=>i});var r=s(10326),a=s(17577),l=s(51223);let n=a.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));n.displayName="Card";let d=a.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",e),...t}));d.displayName="CardHeader";let i=a.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));i.displayName="CardTitle";let o=a.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:(0,l.cn)("text-sm text-muted-foreground",e),...t}));o.displayName="CardDescription";let c=a.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:(0,l.cn)("p-6 pt-0",e),...t}));c.displayName="CardContent",a.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:(0,l.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter"},41190:(e,t,s)=>{"use strict";s.d(t,{I:()=>n});var r=s(10326),a=s(17577),l=s(51223);let n=a.forwardRef(({className:e,type:t,...s},a)=>r.jsx("input",{type:t,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...s}));n.displayName="Input"},79481:(e,t,s)=>{"use strict";var r,a,l,n;s.d(t,{B6:()=>a,KD:()=>n,x8:()=>r}),function(e){e.DRAFT="DRAFT",e.PUBLISHED="PUBLISHED"}(r||(r={})),function(e){e.PENDING="PENDING",e.RUNNING="RUNNING",e.COMPLETED="COMPLETED",e.FAILED="FAILED"}(a||(a={})),function(e){e.MANUAL="MANUAL",e.CRON="CRON"}(l||(l={})),function(e){e.CREATED="CREATED",e.PENDING="PENDING",e.RUNNING="RUNNING",e.COMPLETED="COMPLETED",e.FAILED="FAILED"}(n||(n={}))},6254:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GetWorkflowExecutionWithPhases:()=>n});var r=s(24330);s(60166);var a=s(27577),l=s(13538);async function n(e){let{userId:t}=(0,a.I)();if(!t)throw Error("账户错误");return l.Z.workflowExecution.findUnique({where:{id:e,userId:t},include:{phases:{orderBy:{number:"asc"}}}})}(0,s(40618).h)([n]),(0,r.j)("02006b721cfdf268750b6832501dc53a02328319",n)},34987:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GetWorkflowPhaseDetails:()=>n});var r=s(27745);s(26461);var a=s(93396),l=s(24831);async function n(e){let{userId:t}=(0,a.auth)();if(!t)throw Error("账户错误");return l.default.executionPhase.findUnique({where:{id:e,execution:{userId:t}},include:{logs:{orderBy:{timestamp:"asc"}}}})}(0,s(85723).ensureServerEntryExports)([n]),(0,r.registerServerReference)("371342ddd9d25e7209bd4ab82d3ac8c0750847c0",n)},77131:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var r=s(19510),a=s(71159),l=s(19541),n=s(50234),d=s(6254),i=s(68570);let o=(0,i.createProxy)(String.raw`E:\Demo\next-workflow\src\app\workflow\runs\[workflowId]\[executionId]\_components\ExecutionViewer.tsx`),{__esModule:c,$$typeof:u}=o;o.default;let x=(0,i.createProxy)(String.raw`E:\Demo\next-workflow\src\app\workflow\runs\[workflowId]\[executionId]\_components\ExecutionViewer.tsx#default`);function f({params:e}){return(0,r.jsxs)("div",{className:"flex flex-col h-screen w-full overflow-hidden",children:[r.jsx(n.ZP,{workflowId:e.workflowId,title:"运行日志",subtitle:`ID: ${e.executionId}`,hideButtons:!0}),r.jsx("section",{className:"flex h-full overflow-auto",children:r.jsx(a.Suspense,{fallback:r.jsx("div",{className:"flex w-full items-center justify-center",children:r.jsx(l.Z,{className:"h-10 w-10 animate-spin stroke-primary"})}),children:r.jsx(p,{executionId:e.executionId})})})]})}async function p({executionId:e}){let t=await (0,d.GetWorkflowExecutionWithPhases)(e);return t?r.jsx(x,{initialData:t}):r.jsx("div",{children:"未找到"})}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[948,547,86,0,370,341,343,130,12,877,730,581,431],()=>s(11325));module.exports=r})();