(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[238],{59040:function(e,t,s){Promise.resolve().then(s.bind(s,70265)),Promise.resolve().then(s.bind(s,42399))},42399:function(e,t,s){"use strict";s.d(t,{default:function(){return I}});var r=s(57437),a=s(2265),l=s(65118),n=s(91907),d=s(44965),i=s(13476),o=s(24241),c=s(40933),u=s(3274),f=s(82208),x=s(29973),m=s(89733),N=s(79055),p=s(48185),j=s(77209),h=s(47304),v=s(71935),b=s(13231),g=s(50210);function y(e){let{status:t}=e;switch(t){case g.KD.PENDING:return(0,r.jsx)(i.Z,{size:20,className:"stroke-muted-foreground"});case g.KD.RUNNING:return(0,r.jsx)(u.Z,{size:20,className:"animate-spin stroke-yellow-500"});case g.KD.FAILED:return(0,r.jsx)(v.Z,{size:20,className:"stroke-destructive"});case g.KD.COMPLETED:return(0,r.jsx)(b.Z,{size:20,className:"stroke-green-500"});default:return(0,r.jsx)("div",{className:"rounded-full",children:{CREATED:"已创建",PENDING:"等待中",RUNNING:"运行中",COMPLETED:"运行成功",FAILED:"已失败"}[t]})}}s(74590);var w=s(58064),E=(0,w.$)("02006b721cfdf268750b6832501dc53a02328319"),D=(0,w.$)("371342ddd9d25e7209bd4ab82d3ac8c0750847c0"),R=s(49354),C=s(23408);function I(e){var t,s,p,j,h,v,b,w,R,I;let{initialData:L}=e,[O,P]=(0,a.useState)(null),S=(0,l.a)({queryKey:["execution",null==L?void 0:L.id],initialData:L,queryFn:()=>E(L.id),refetchInterval:e=>{var t;return(null===(t=e.state.data)||void 0===t?void 0:t.status)===g.B6.RUNNING&&1e3}}),G=(0,l.a)({queryKey:["phaseDetails",O,null===(t=S.data)||void 0===t?void 0:t.status],enabled:null!==O,queryFn:()=>D(O)}),Z=(null===(s=S.data)||void 0===s?void 0:s.status)===g.B6.RUNNING;(0,a.useEffect)(()=>{var e;let t=(null===(e=S.data)||void 0===e?void 0:e.phases)||[];if(Z){P(t.toSorted((e,t)=>e.startedAt>t.startedAt?-1:1)[0].id);return}P(t.toSorted((e,t)=>e.completedAt>t.completedAt?-1:1)[0].id)},[null===(p=S.data)||void 0===p?void 0:p.phases,Z,P]);let U=(0,C.h)(null===(j=S.data)||void 0===j?void 0:j.completedAt,null===(h=S.data)||void 0===h?void 0:h.startedAt);return(0,r.jsxs)("div",{className:"flex w-full h-full",children:[(0,r.jsxs)("aside",{className:"w-[440px] min-w-[440px] max-w-[440px] border-r-2 border-separate flex flex-grow flex-col overflow-hidden",children:[(0,r.jsxs)("div",{className:"py-4 px-2",children:[(0,r.jsx)(A,{icon:i.Z,label:"状态",value:(0,r.jsxs)("div",{className:"font-semibold capitalize flex gap-2 items-center",children:[(0,r.jsx)(y,{status:null===(v=S.data)||void 0===v?void 0:v.status}),(0,r.jsx)("span",{children:{CREATED:"已创建",PENDING:"等待中",RUNNING:"运行中",COMPLETED:"运行成功",FAILED:"已失败"}[null===(b=S.data)||void 0===b?void 0:b.status]})]})}),(0,r.jsx)(A,{icon:o.Z,label:"开始时间",value:(0,r.jsx)("span",{className:"lowercase",children:(null===(w=S.data)||void 0===w?void 0:w.startedAt)?(0,n.Q)(new Date(null===(R=S.data)||void 0===R?void 0:R.startedAt),{addSuffix:!0,locale:d.U}):"-"})}),(0,r.jsx)(A,{icon:c.Z,label:"运行时间",value:U||(0,r.jsx)(u.Z,{size:20,className:"animate-spin"})})]}),(0,r.jsx)(x.Separator,{}),(0,r.jsx)("div",{className:"flex justify-center items-center py-2 px-4",children:(0,r.jsxs)("div",{className:"text-muted-foreground flex items-center gap-2",children:[(0,r.jsx)(f.Z,{size:20,className:"stroke-muted-foreground/80"}),(0,r.jsx)("span",{className:"font-semibold",children:"运行步骤"})]})}),(0,r.jsx)(x.Separator,{}),(0,r.jsx)("div",{className:"overflow-auto h-full px-2 py-4",children:null===(I=S.data)||void 0===I?void 0:I.phases.map((e,t)=>(0,r.jsxs)(m.z,{variant:O===e.id?"secondary":"ghost",className:"w-full justify-between",onClick:()=>{Z||P(e.id)},children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(N.C,{variant:"outline",children:t+1}),(0,r.jsx)("p",{className:"font-semibold",children:e.name})]}),(0,r.jsx)(y,{status:e.status})]},e.id))})]}),(0,r.jsxs)("div",{className:"flex w-full h-full",children:[Z&&(0,r.jsx)("div",{className:"flex items-center flex-col gap-2 justify-center h-full w-full",children:(0,r.jsx)("p",{className:"font-bold",children:"正在运行, 请等待"})}),!Z&&!O&&(0,r.jsx)("div",{className:"flex items-center flex-col gap-2 justify-center h-full w-full",children:(0,r.jsxs)("div",{className:"flex flex-col gap-1 text-center",children:[(0,r.jsx)("p",{className:"font-bold",children:"没有步骤被选中"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"请选择步骤查看详细信息"})]})}),!Z&&O&&G.data&&(0,r.jsxs)("div",{className:"flex flex-col py-4 container gap-4 overflow-auto",children:[(0,r.jsx)("div",{className:"flex gap-2 items-center",children:(0,r.jsxs)(N.C,{variant:"outline",className:"space-x-4",children:[(0,r.jsxs)("div",{className:"flex gap-1 items-center",children:[(0,r.jsx)(c.Z,{size:18,className:"stroke-muted-foreground"}),(0,r.jsx)("span",{children:"运行时间"})]}),(0,r.jsx)("span",{children:(0,C.h)(G.data.completedAt,G.data.startedAt)||"-"})]})}),(0,r.jsx)(T,{title:"输入",subtitle:"用于此阶段的输入",paramsJson:G.data.inputs}),(0,r.jsx)(T,{title:"输出",subtitle:"此阶段生成的输出",paramsJson:G.data.outputs}),(0,r.jsx)(k,{logs:G.data.logs})]})]})]})}function A(e){let{icon:t,label:s,value:a}=e;return(0,r.jsxs)("div",{className:"flex justify-between items-center py-2 px-4 text-sm",children:[(0,r.jsxs)("div",{className:"text-muted-foreground flex items-center gap-2",children:[(0,r.jsx)(t,{size:20,className:"stroke-muted-foreground/80"}),(0,r.jsx)("span",{children:s})]}),(0,r.jsx)("div",{className:"font-semibold capitalize flex gap-2 items-center",children:a})]})}function T(e){let{title:t,subtitle:s,paramsJson:a}=e,l=a?JSON.parse(a):void 0;return(0,r.jsxs)(p.Zb,{children:[(0,r.jsxs)(p.Ol,{className:"rounded-lg rounded-b-none border-b py-4 bg-gray-50 dark:bg-background",children:[(0,r.jsx)(p.ll,{className:"text-base",children:t}),(0,r.jsx)(p.SZ,{className:"text-muted-foreground text-sm",children:s})]}),(0,r.jsx)(p.aY,{className:"py-4",children:(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(!l||0===Object.keys(l).length)&&(0,r.jsx)("p",{className:"text-sm",children:"此阶段未生成任何参数"}),l&&Object.entries(l).map(e=>{let[t,s]=e;return(0,r.jsxs)("div",{className:"flex justify-between items-center space-y-1",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground flex-1 basis-1/3",children:t}),(0,r.jsx)(j.I,{readOnly:!0,className:"flex-1 basis-2/3",value:s})]},t)})]})})]})}function k(e){let{logs:t}=e;return t&&0!==t.length?(0,r.jsxs)(p.Zb,{className:"w-full",children:[(0,r.jsxs)(p.Ol,{className:"rounded-lg rounded-b-none border-b py-4 bg-gray-50 dark:bg-background",children:[(0,r.jsx)(p.ll,{className:"text-base",children:"日志"}),(0,r.jsx)(p.SZ,{className:"text-muted-foreground text-sm",children:"此阶段生成的日志"})]}),(0,r.jsx)(p.aY,{className:"p-0",children:(0,r.jsxs)(h.iA,{children:[(0,r.jsx)(h.xD,{className:"text-muted-foreground text-sm",children:(0,r.jsxs)(h.SC,{children:[(0,r.jsx)(h.ss,{children:"日期"}),(0,r.jsx)(h.ss,{children:"类型"}),(0,r.jsx)(h.ss,{children:"消息"})]})}),(0,r.jsx)(h.RM,{children:t.map(e=>(0,r.jsxs)(h.SC,{className:"text-muted-foreground",children:[(0,r.jsx)(h.pj,{width:190,className:"text-xs text-muted-foreground p-[2px] pl-4",children:e.timestamp.toISOString()}),(0,r.jsx)(h.pj,{width:80,className:(0,R.cn)("uppercase text-xs font-bold p-[3px] pl-4","error"===e.logLevel&&"text-destructive","info"===e.logLevel&&"text-primary"),children:e.logLevel}),(0,r.jsx)(h.pj,{className:"text-sm flex-1 p-[3px] pl-4",children:e.message})]},e.id))})]})})]}):null}},79055:function(e,t,s){"use strict";s.d(t,{C:function(){return d}});var r=s(57437);s(2265);var a=s(13027),l=s(49354);let n=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d(e){let{className:t,variant:s,...a}=e;return(0,r.jsx)("div",{className:(0,l.cn)(n({variant:s}),t),...a})}},48185:function(e,t,s){"use strict";s.d(t,{Ol:function(){return d},SZ:function(){return o},Zb:function(){return n},aY:function(){return c},ll:function(){return i}});var r=s(57437),a=s(2265),l=s(49354);let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a})});n.displayName="Card";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",s),...a})});d.displayName="CardHeader";let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",s),...a})});i.displayName="CardTitle";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",s),...a})});o.displayName="CardDescription";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",s),...a})});c.displayName="CardContent",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",s),...a})}).displayName="CardFooter"},77209:function(e,t,s){"use strict";s.d(t,{I:function(){return n}});var r=s(57437),a=s(2265),l=s(49354);let n=a.forwardRef((e,t)=>{let{className:s,type:a,...n}=e;return(0,r.jsx)("input",{type:a,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...n})});n.displayName="Input"},29973:function(e,t,s){"use strict";s.d(t,{Separator:function(){return d}});var r=s(57437),a=s(2265),l=s(48484),n=s(49354);let d=a.forwardRef((e,t)=>{let{className:s,orientation:a="horizontal",decorative:d=!0,...i}=e;return(0,r.jsx)(l.f,{ref:t,decorative:d,orientation:a,className:(0,n.cn)("shrink-0 bg-border","horizontal"===a?"h-[1px] w-full":"h-full w-[1px]",s),...i})});d.displayName=l.f.displayName},47304:function(e,t,s){"use strict";s.d(t,{RM:function(){return i},SC:function(){return o},iA:function(){return n},pj:function(){return u},ss:function(){return c},xD:function(){return d}});var r=s(57437),a=s(2265),l=s(49354);let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:t,className:(0,l.cn)("w-full caption-bottom text-sm",s),...a})})});n.displayName="Table";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("thead",{ref:t,className:(0,l.cn)("[&_tr]:border-b",s),...a})});d.displayName="TableHeader";let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("tbody",{ref:t,className:(0,l.cn)("[&_tr:last-child]:border-0",s),...a})});i.displayName="TableBody",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("tfoot",{ref:t,className:(0,l.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...a})}).displayName="TableFooter";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("tr",{ref:t,className:(0,l.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...a})});o.displayName="TableRow";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("th",{ref:t,className:(0,l.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...a})});c.displayName="TableHead";let u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("td",{ref:t,className:(0,l.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...a})});u.displayName="TableCell",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("caption",{ref:t,className:(0,l.cn)("mt-4 text-sm text-muted-foreground",s),...a})}).displayName="TableCaption"},23408:function(e,t,s){"use strict";s.d(t,{h:function(){return a}});var r=s(81956);function a(e,t){if(!t||!e)return null;let s=e.getTime()-t.getTime();if(s<1e3)return"".concat(s,"ms");let a=(0,r.y)({start:0,end:s});return"".concat(a.minutes||0,"m ").concat(a.seconds||0,"s")}},50210:function(e,t,s){"use strict";var r,a,l,n,d,i,o,c;s.d(t,{B6:function(){return a},KD:function(){return n},x8:function(){return r}}),(d=r||(r={})).DRAFT="DRAFT",d.PUBLISHED="PUBLISHED",(i=a||(a={})).PENDING="PENDING",i.RUNNING="RUNNING",i.COMPLETED="COMPLETED",i.FAILED="FAILED",(o=l||(l={})).MANUAL="MANUAL",o.CRON="CRON",(c=n||(n={})).CREATED="CREATED",c.PENDING="PENDING",c.RUNNING="RUNNING",c.COMPLETED="COMPLETED",c.FAILED="FAILED"}},function(e){e.O(0,[167,899,231,353,63,673,864,405,41,265,971,23,744],function(){return e(e.s=59040)}),_N_E=e.O()}]);